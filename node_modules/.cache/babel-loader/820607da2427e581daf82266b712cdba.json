{"ast":null,"code":"import { List, Set } from 'immutable';\nexport function timeline() {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new List();\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  if (action.type === 'LISTAGEM') {\n    return new List(action.fotos);\n  }\n\n  if (action.type === 'COMENTARIO') {\n    const fotoEstadoAntigo = state.find(foto => foto.id === action.fotoId);\n    const novosComentarios = fotoEstadoAntigo.comentarios.concat(action.novoComentario);\n    const fotoEstadoNovo = Object.assign({}, fotoEstadoAntigo, {\n      comentarios: novosComentarios\n    });\n    const indiceDaLista = state.findIndex(foto => foto.id === action.fotoId);\n    const novaLista = state.set(indiceDaLista, fotoEstadoNovo);\n    return novaLista;\n  }\n\n  if (action.type === 'LIKE') {\n    const fotoAchada = state.find(foto => foto.id === action.fotoId);\n    fotoAchada.likeada = !fotoAchada.likeada;\n    const liker = action.liker;\n    const possivelLiker = fotoAchada.likers.find(likerAtual => likerAtual.login === liker.login);\n\n    if (possivelLiker === undefined) {\n      fotoAchada.likers.push(liker);\n    } else {\n      const novosLikers = fotoAchada.likers.filter(likerAtual => likerAtual.login !== liker.login);\n      fotoAchada.likers = novosLikers;\n    }\n\n    return state;\n  }\n\n  return state;\n}","map":{"version":3,"sources":["/home/joaohgs/Documents/ProjetosReact/instalura/src/reducers/timeline.js"],"names":["List","Set","timeline","state","action","type","fotos","fotoEstadoAntigo","find","foto","id","fotoId","novosComentarios","comentarios","concat","novoComentario","fotoEstadoNovo","Object","assign","indiceDaLista","findIndex","novaLista","set","fotoAchada","likeada","liker","possivelLiker","likers","likerAtual","login","undefined","push","novosLikers","filter"],"mappings":"AAAA,SAAQA,IAAR,EAAcC,GAAd,QAAwB,WAAxB;AAEA,OAAO,SAASC,QAAT,GAA0C;AAAA,MAAxBC,KAAwB,uEAAlB,IAAIH,IAAJ,EAAkB;AAAA,MAAPI,MAAO;;AAC7C,MAAGA,MAAM,CAACC,IAAP,KAAgB,UAAnB,EAA8B;AAC5B,WAAO,IAAIL,IAAJ,CAASI,MAAM,CAACE,KAAhB,CAAP;AACD;;AAED,MAAGF,MAAM,CAACC,IAAP,KAAgB,YAAnB,EAAgC;AAC5B,UAAME,gBAAgB,GAAGJ,KAAK,CAACK,IAAN,CAAWC,IAAI,IAAIA,IAAI,CAACC,EAAL,KAAYN,MAAM,CAACO,MAAtC,CAAzB;AACA,UAAMC,gBAAgB,GAAGL,gBAAgB,CAACM,WAAjB,CAA6BC,MAA7B,CAAoCV,MAAM,CAACW,cAA3C,CAAzB;AACA,UAAMC,cAAc,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAiBX,gBAAjB,EAAkC;AAACM,MAAAA,WAAW,EAACD;AAAb,KAAlC,CAAvB;AACA,UAAMO,aAAa,GAAGhB,KAAK,CAACiB,SAAN,CAAgBX,IAAI,IAAIA,IAAI,CAACC,EAAL,KAAYN,MAAM,CAACO,MAA3C,CAAtB;AACA,UAAMU,SAAS,GAAGlB,KAAK,CAACmB,GAAN,CAAUH,aAAV,EAAwBH,cAAxB,CAAlB;AACA,WAAOK,SAAP;AACH;;AAED,MAAGjB,MAAM,CAACC,IAAP,KAAgB,MAAnB,EAA0B;AACpB,UAAMkB,UAAU,GAAGpB,KAAK,CAACK,IAAN,CAAWC,IAAI,IAAIA,IAAI,CAACC,EAAL,KAAYN,MAAM,CAACO,MAAtC,CAAnB;AACAY,IAAAA,UAAU,CAACC,OAAX,GAAqB,CAACD,UAAU,CAACC,OAAjC;AAEA,UAAMC,KAAK,GAAGrB,MAAM,CAACqB,KAArB;AACA,UAAMC,aAAa,GAAGH,UAAU,CAACI,MAAX,CAAkBnB,IAAlB,CAAuBoB,UAAU,IAAIA,UAAU,CAACC,KAAX,KAAqBJ,KAAK,CAACI,KAAhE,CAAtB;;AAEA,QAAGH,aAAa,KAAKI,SAArB,EAA+B;AAC3BP,MAAAA,UAAU,CAACI,MAAX,CAAkBI,IAAlB,CAAuBN,KAAvB;AACH,KAFD,MAEO;AACH,YAAMO,WAAW,GAAGT,UAAU,CAACI,MAAX,CAAkBM,MAAlB,CAAyBL,UAAU,IAAIA,UAAU,CAACC,KAAX,KAAqBJ,KAAK,CAACI,KAAlE,CAApB;AACAN,MAAAA,UAAU,CAACI,MAAX,GAAoBK,WAApB;AACH;;AAED,WAAO7B,KAAP;AACL;;AAED,SAAOA,KAAP;AACD","sourcesContent":["import {List, Set} from 'immutable';\n\nexport function timeline(state=new List(),action){\n    if(action.type === 'LISTAGEM'){  \n      return new List(action.fotos);\n    }\n  \n    if(action.type === 'COMENTARIO'){\n        const fotoEstadoAntigo = state.find(foto => foto.id === action.fotoId);        \n        const novosComentarios = fotoEstadoAntigo.comentarios.concat(action.novoComentario); \n        const fotoEstadoNovo = Object.assign({},fotoEstadoAntigo,{comentarios:novosComentarios});\n        const indiceDaLista = state.findIndex(foto => foto.id === action.fotoId)\n        const novaLista = state.set(indiceDaLista,fotoEstadoNovo);\n        return novaLista;\n    }\n  \n    if(action.type === 'LIKE'){\n          const fotoAchada = state.find(foto => foto.id === action.fotoId);\n          fotoAchada.likeada = !fotoAchada.likeada;\n          \n          const liker = action.liker;\n          const possivelLiker = fotoAchada.likers.find(likerAtual => likerAtual.login === liker.login);\n  \n          if(possivelLiker === undefined){\n              fotoAchada.likers.push(liker);\n          } else {\n              const novosLikers = fotoAchada.likers.filter(likerAtual => likerAtual.login !== liker.login);\n              fotoAchada.likers = novosLikers;\n          }\n  \n          return state;\n    }\n  \n    return state;\n  }"]},"metadata":{},"sourceType":"module"}