{"ast":null,"code":"import { List, Set } from 'immutable';\nexport function timeline() {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new List();\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  function trocaFoto() {\n    const fotoEstadoAntigo = state.find(foto => foto.id === action.fotoId);\n    const fotoEstadoNovo = Object.assign({}, fotoEstadoAntigo, {\n      comentarios: novosComentarios\n    });\n    const indiceDaLista = state.findIndex(foto => foto.id === action.fotoId);\n    return state.set(indiceDaLista, fotoEstadoNovo);\n  }\n\n  if (action.type === 'LISTAGEM') {\n    return new List(action.fotos);\n  }\n\n  if (action.type === 'COMENTARIO') {\n    const fotoEstadoAntigo = state.find(foto => foto.id === action.fotoId);\n    const novosComentarios = fotoEstadoAntigo.comentarios.concat(action.novoComentario);\n    const fotoEstadoNovo = Object.assign({}, fotoEstadoAntigo, {\n      comentarios: novosComentarios\n    });\n    const indiceDaLista = state.findIndex(foto => foto.id === action.fotoId);\n    const novaLista = state.set(indiceDaLista, fotoEstadoNovo);\n    return novaLista;\n  }\n\n  if (action.type === 'LIKE') {\n    const fotoAchada = state.find(foto => foto.id === action.fotoId);\n    fotoAchada.likeada = !fotoAchada.likeada;\n    const liker = action.liker;\n    const possivelLiker = fotoAchada.likers.find(likerAtual => likerAtual.login === liker.login);\n\n    if (possivelLiker === undefined) {\n      fotoAchada.likers.push(liker);\n    } else {\n      const novosLikers = fotoAchada.likers.filter(likerAtual => likerAtual.login !== liker.login);\n      fotoAchada.likers = novosLikers;\n    }\n\n    return state;\n  }\n\n  return state;\n}","map":{"version":3,"sources":["/home/joaohgs/Documents/ProjetosReact/instalura/src/reducers/timeline.js"],"names":["List","Set","timeline","state","action","trocaFoto","fotoEstadoAntigo","find","foto","id","fotoId","fotoEstadoNovo","Object","assign","comentarios","novosComentarios","indiceDaLista","findIndex","set","type","fotos","concat","novoComentario","novaLista","fotoAchada","likeada","liker","possivelLiker","likers","likerAtual","login","undefined","push","novosLikers","filter"],"mappings":"AAAA,SAAQA,IAAR,EAAcC,GAAd,QAAwB,WAAxB;AAIA,OAAO,SAASC,QAAT,GAA0C;AAAA,MAAxBC,KAAwB,uEAAlB,IAAIH,IAAJ,EAAkB;AAAA,MAAPI,MAAO;;AAE7C,WAASC,SAAT,GAAoB;AAChB,UAAMC,gBAAgB,GAAGH,KAAK,CAACI,IAAN,CAAWC,IAAI,IAAIA,IAAI,CAACC,EAAL,KAAYL,MAAM,CAACM,MAAtC,CAAzB;AACA,UAAMC,cAAc,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAiBP,gBAAjB,EAAkC;AAACQ,MAAAA,WAAW,EAACC;AAAb,KAAlC,CAAvB;AAED,UAAMC,aAAa,GAAGb,KAAK,CAACc,SAAN,CAAgBT,IAAI,IAAIA,IAAI,CAACC,EAAL,KAAYL,MAAM,CAACM,MAA3C,CAAtB;AACA,WAAOP,KAAK,CAACe,GAAN,CAAUF,aAAV,EAAwBL,cAAxB,CAAP;AACF;;AAED,MAAGP,MAAM,CAACe,IAAP,KAAgB,UAAnB,EAA8B;AAC5B,WAAO,IAAInB,IAAJ,CAASI,MAAM,CAACgB,KAAhB,CAAP;AACD;;AAED,MAAGhB,MAAM,CAACe,IAAP,KAAgB,YAAnB,EAAgC;AAC5B,UAAMb,gBAAgB,GAAGH,KAAK,CAACI,IAAN,CAAWC,IAAI,IAAIA,IAAI,CAACC,EAAL,KAAYL,MAAM,CAACM,MAAtC,CAAzB;AACA,UAAMK,gBAAgB,GAAGT,gBAAgB,CAACQ,WAAjB,CAA6BO,MAA7B,CAAoCjB,MAAM,CAACkB,cAA3C,CAAzB;AACA,UAAMX,cAAc,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAiBP,gBAAjB,EAAkC;AAACQ,MAAAA,WAAW,EAACC;AAAb,KAAlC,CAAvB;AACA,UAAMC,aAAa,GAAGb,KAAK,CAACc,SAAN,CAAgBT,IAAI,IAAIA,IAAI,CAACC,EAAL,KAAYL,MAAM,CAACM,MAA3C,CAAtB;AACA,UAAMa,SAAS,GAAGpB,KAAK,CAACe,GAAN,CAAUF,aAAV,EAAwBL,cAAxB,CAAlB;AACA,WAAOY,SAAP;AACH;;AAED,MAAGnB,MAAM,CAACe,IAAP,KAAgB,MAAnB,EAA0B;AACpB,UAAMK,UAAU,GAAGrB,KAAK,CAACI,IAAN,CAAWC,IAAI,IAAIA,IAAI,CAACC,EAAL,KAAYL,MAAM,CAACM,MAAtC,CAAnB;AACAc,IAAAA,UAAU,CAACC,OAAX,GAAqB,CAACD,UAAU,CAACC,OAAjC;AAEA,UAAMC,KAAK,GAAGtB,MAAM,CAACsB,KAArB;AACA,UAAMC,aAAa,GAAGH,UAAU,CAACI,MAAX,CAAkBrB,IAAlB,CAAuBsB,UAAU,IAAIA,UAAU,CAACC,KAAX,KAAqBJ,KAAK,CAACI,KAAhE,CAAtB;;AAEA,QAAGH,aAAa,KAAKI,SAArB,EAA+B;AAC3BP,MAAAA,UAAU,CAACI,MAAX,CAAkBI,IAAlB,CAAuBN,KAAvB;AACH,KAFD,MAEO;AACH,YAAMO,WAAW,GAAGT,UAAU,CAACI,MAAX,CAAkBM,MAAlB,CAAyBL,UAAU,IAAIA,UAAU,CAACC,KAAX,KAAqBJ,KAAK,CAACI,KAAlE,CAApB;AACAN,MAAAA,UAAU,CAACI,MAAX,GAAoBK,WAApB;AACH;;AAED,WAAO9B,KAAP;AACL;;AAED,SAAOA,KAAP;AACD","sourcesContent":["import {List, Set} from 'immutable';\n\n\n\nexport function timeline(state=new List(),action){\n    \n    function trocaFoto(){\n        const fotoEstadoAntigo = state.find(foto => foto.id === action.fotoId);\n        const fotoEstadoNovo = Object.assign({},fotoEstadoAntigo,{comentarios:novosComentarios});\n   \n       const indiceDaLista = state.findIndex(foto => foto.id === action.fotoId);\n       return state.set(indiceDaLista,fotoEstadoNovo);\n    }\n\n    if(action.type === 'LISTAGEM'){  \n      return new List(action.fotos);\n    }\n  \n    if(action.type === 'COMENTARIO'){\n        const fotoEstadoAntigo = state.find(foto => foto.id === action.fotoId);        \n        const novosComentarios = fotoEstadoAntigo.comentarios.concat(action.novoComentario); \n        const fotoEstadoNovo = Object.assign({},fotoEstadoAntigo,{comentarios:novosComentarios});\n        const indiceDaLista = state.findIndex(foto => foto.id === action.fotoId)\n        const novaLista = state.set(indiceDaLista,fotoEstadoNovo);\n        return novaLista;\n    }\n  \n    if(action.type === 'LIKE'){\n          const fotoAchada = state.find(foto => foto.id === action.fotoId);\n          fotoAchada.likeada = !fotoAchada.likeada;\n          \n          const liker = action.liker;\n          const possivelLiker = fotoAchada.likers.find(likerAtual => likerAtual.login === liker.login);\n  \n          if(possivelLiker === undefined){\n              fotoAchada.likers.push(liker);\n          } else {\n              const novosLikers = fotoAchada.likers.filter(likerAtual => likerAtual.login !== liker.login);\n              fotoAchada.likers = novosLikers;\n          }\n  \n          return state;\n    }\n  \n    return state;\n  }"]},"metadata":{},"sourceType":"module"}